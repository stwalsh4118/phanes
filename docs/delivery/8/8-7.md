# 8-7 Add dry-run mode integration

[Back to task list](./tasks.md)

## Description

Integrate the dry-run flag throughout the CLI execution flow. This includes setting logging dry-run mode and passing dry-run flag to the runner so modules can preview actions without executing them.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-01-27 00:00:00 | Created | N/A | Proposed | Task file created | sean |

## Requirements

1. Set logging dry-run mode when `--dry-run` flag is set (already done in 8-1, verify)
2. Pass dry-run flag to `runner.RunModules()`
3. Ensure dry-run mode is respected throughout execution
4. Log when dry-run mode is enabled
5. Verify dry-run mode works end-to-end

## Implementation Plan

1. Verify `log.SetDryRun()` is called in `runCommand()` when `--dry-run` Cobra flag is set (from task 8-1)
2. Ensure dry-run flag is passed to `executeModules()` function
3. Pass dry-run flag to `runner.RunModules()` call
4. Add log message when dry-run mode is enabled:
   - Log info message: "Dry-run mode enabled. No changes will be made."
5. Test dry-run mode:
   - Run with `--dry-run` flag
   - Verify logging shows dry-run field
   - Verify modules don't actually execute (check IsInstalled but don't Install)
   - Verify output shows what would happen

## Verification

1. Dry-run flag sets logging dry-run mode correctly
2. Dry-run flag is passed to runner
3. Dry-run mode message is logged
4. Modules respect dry-run mode (preview only, no execution)
5. Output clearly indicates dry-run mode

## Test Plan

1. **Dry-run logging**: Run with `--dry-run`, verify log entries have dry_run field
2. **Dry-run execution**: Run with `--dry-run`, verify modules check but don't install
3. **Dry-run message**: Verify dry-run enabled message is shown
4. **Normal execution**: Run without `--dry-run`, verify normal execution

## Files Modified

- `main.go` (updated)

