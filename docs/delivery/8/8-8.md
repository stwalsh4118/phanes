# 8-8 Add error handling and exit codes

[Back to task list](./tasks.md)

## Description

Implement comprehensive error handling throughout the CLI with clear, actionable error messages and proper exit codes. This ensures users get helpful feedback when things go wrong.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-01-27 00:00:00 | Created | N/A | Proposed | Task file created | sean |

## Requirements

1. Handle all error cases with clear messages:
   - Config file errors (not found, invalid YAML, validation failures)
   - Profile errors (not found, invalid)
   - Module errors (not found, execution failures)
   - Flag validation errors
2. Use `log.Error()` for all errors
3. Exit codes:
   - 0: Success
   - 1: Error (general error)
   - 2: Invalid usage (wrong flags, etc.)
4. Provide actionable error messages (suggest fixes, show available options)
5. Handle panics gracefully (recover if needed)

## Implementation Plan

1. Review all error paths in `main.go` (specifically in `runCommand()` function):
   - Config loading errors
   - Profile selection errors
   - Module parsing errors
   - Module execution errors
   - Flag validation errors
2. Add error handling wrapper or helper:
   - Create `handleError(err error, message string, exitCode int)` function
   - Log error with context
   - Exit with appropriate code
3. Update all error handling:
   - Config loading: Show file path, suggest checking file exists
   - Profile errors: Show available profiles
   - Module errors: Show available modules (if possible)
   - Execution errors: Show which module failed
4. Add panic recovery in `runCommand()` or `main()`:
   - Recover from panics
   - Log panic message
   - Exit with code 1
5. Test error scenarios:
   - Invalid config file
   - Invalid profile
   - Invalid module
   - Execution failure

## Verification

1. All errors are handled gracefully
2. Error messages are clear and actionable
3. Exit codes are correct (0 for success, 1/2 for errors)
4. Panics are recovered and logged
5. Users can understand what went wrong and how to fix it

## Test Plan

1. **Config errors**: Test invalid config file, verify clear error
2. **Profile errors**: Test invalid profile, verify shows available profiles
3. **Module errors**: Test invalid module, verify shows available modules
4. **Execution errors**: Test module execution failure, verify error message
5. **Exit codes**: Verify correct exit codes for each error type
6. **Panic recovery**: Test panic scenario, verify recovery

## Files Modified

- `main.go` (updated)

