# 7-4 Implement DevTools module - Python and uv

[Back to task list](./tasks.md)

## Description

Implement helper functions for installing system Python 3 and uv package manager. Python is installed via apt, and uv is installed via the official installer script.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-01-27 00:00:00 | Created | N/A | Proposed | Task file created | sean |

## Requirements

1. Create helper functions in `internal/modules/devtools/python.go`:
   - `installPython(cfg *config.Config) error` - Installs Python 3 and optionally uv
   - `pythonInstalled() (bool, error)` - Checks if Python 3 is installed
   - `uvInstalled(username string) (bool, error)` - Checks if uv is installed for user

2. Install Python 3:
   - Install via apt: `apt-get install -y python3 python3-venv python3-pip`
   - Verify installation: `python3 --version`
   - Use system Python (default Python 3.x from apt)

3. Install uv (if `cfg.DevTools.InstallUv` is true):
   - Download and run uv installer: `curl -LsSf https://astral.sh/uv/install.sh | sh`
   - Install to user's home directory: `~/.cargo/bin/uv` or `~/.local/bin/uv`
   - Configure PATH in shell profile (`.bashrc` and `.zshrc`) if needed
   - Requires `cfg.User.Username` to be set if installing uv
   - Verify installation: `uv --version`

4. Shell profile configuration (for uv):
   - Append uv PATH to `.bashrc` and `.zshrc` if not already present
   - Check for existing uv PATH entries to avoid duplicates
   - Pattern: `export PATH="$HOME/.cargo/bin:$PATH"` or `export PATH="$HOME/.local/bin:$PATH"`

5. Idempotency:
   - Check if Python 3 is already installed before installing
   - Check if uv is already installed before installing (if InstallUv is true)
   - Return early if already configured

6. Error handling:
   - Handle apt update errors
   - Handle Python installation errors
   - Handle uv installation script errors
   - Handle shell profile write errors
   - Handle missing username error (for uv)
   - Return descriptive errors

7. Logging:
   - Use `log.Info()` for progress messages
   - Use `log.Success()` when installation completes
   - Use `log.Skip()` when already installed
   - Use `log.Warn()` if username is not set (for uv)

8. Dry-run support:
   - Check dry-run mode from logging package
   - Log what would be done but don't execute commands

## Implementation Plan

1. Create `internal/modules/devtools/python.go`
2. Implement helper functions for checking Python and uv installation
3. Implement `installPython()` function
4. Implement shell profile configuration helpers (for uv)
5. Add proper error handling and logging
6. Add dry-run support

## Verification

1. Functions compile without errors
2. Python 3 installation works correctly
3. uv installation works correctly (when enabled)
4. Shell profile configuration works correctly (for uv)
5. Idempotency works (can run multiple times safely)
6. Error handling works correctly
7. Dry-run mode is respected

## Files Modified

- `internal/modules/devtools/python.go` (new) - Python and uv installation functions


