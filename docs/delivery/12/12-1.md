# 12-1 Add Backup Configuration Struct

[Back to task list](./tasks.md)

## Description

Add Backup configuration struct to `internal/config/config.go` with Enabled, Repository, Password, Paths, Schedule, and Retention fields, following the existing config patterns.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-01-27 00:00:00 | Created | N/A | Proposed | Task file created | sean |

## Requirements

1. Add `Backup` field to main `Config` struct in `internal/config/config.go`
2. Define `Backup` struct with:
   - `Enabled bool` - Whether to configure backups
   - `Repository string` - Repository URL or path (supports local/S3/B2/SFTP backends)
   - `Password string` - Repository encryption password
   - `Paths []string` - Paths to back up
   - `Schedule string` - Cron expression or systemd timer spec (e.g., "0 2 * * *" for daily at 2 AM)
   - `Retention string` - Retention policy (e.g., "30d" for 30 days)
3. Add defaults in `DefaultConfig()`:
   - Enabled: false
   - Repository: ""
   - Password: ""
   - Paths: []string{}
   - Schedule: "0 2 * * *" (daily at 2 AM)
   - Retention: "30d" (30 days)
4. Add validation in `Validate()`: if Backup.Enabled is true, Repository and Password must be non-empty

## Implementation Plan

1. Add `Backup Backup` field to `Config` struct
2. Create `Backup` struct type with all required fields
3. Add YAML tags (`yaml:"enabled"`, `yaml:"repository"`, `yaml:"password"`, `yaml:"paths"`, `yaml:"schedule"`, `yaml:"retention"`)
4. Add documentation comments following existing patterns explaining:
   - Repository URL formats for different backends (local, S3, B2, SFTP)
   - Schedule format (cron expression)
   - Retention policy format
5. Add default values in `DefaultConfig()` function
6. Add validation logic in `Validate()` function to check Repository and Password when enabled

## Verification

1. Config struct compiles without errors
2. Default values are correctly set
3. Validation correctly checks Repository and Password when Backup is enabled
4. Documentation comments are clear and follow existing patterns
5. YAML tags match the field names appropriately

## Files Modified

- `internal/config/config.go` - Add Backup struct and configuration

