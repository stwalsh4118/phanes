# 12-3 Register Module and Update Examples

[Back to task list](./tasks.md)

## Description

Register the Backup module in `main.go` and update `config.yaml.example` with Backup configuration options.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-01-27 00:00:00 | Created | N/A | Proposed | Task file created | sean |

## Requirements

1. Register Backup module in `main.go` `registerAllModules()` function
2. Import Backup module package
3. Add module registration: `r.RegisterModule(&backup.BackupModule{})`
4. Update `config.yaml.example` with Backup section:
   - `enabled: false` with comment
   - `repository: ""` with comment explaining repository URL formats for different backends:
     - Local: `/backups/repo` or `file:/backups/repo`
     - S3: `s3:s3.amazonaws.com/bucket-name/path` or `s3:https://s3.amazonaws.com/bucket-name/path`
     - B2: `b2:bucket-name:path`
     - SFTP: `sftp:user@host:/path`
   - `password: ""` with comment about repository encryption password
   - `paths: []` with comment and example paths (e.g., `["/home", "/etc", "/var/log"]`)
   - `schedule: "0 2 * * *"` with comment explaining cron format (daily at 2 AM)
   - `retention: "30d"` with comment explaining retention policy format (e.g., "30d", "12m", "keep-last 10")

## Implementation Plan

1. Open `main.go` file
2. Add import for `github.com/stwalsh4118/phanes/internal/modules/backup`
3. Add `r.RegisterModule(&backup.BackupModule{})` in `registerAllModules()` function (after other module registrations)
4. Open `config.yaml.example` file
5. Add Backup section with:
   - Comment explaining what the backup module does (restic backup tool)
   - `enabled: false` with comment
   - `repository: ""` with detailed comment explaining repository URL formats for all supported backends
   - `password: ""` with comment explaining repository encryption password requirement
   - `paths: []` with comment and example showing what paths to backup
   - `schedule: "0 2 * * *"` with comment explaining cron expression format
   - `retention: "30d"` with comment explaining retention policy options

## Verification

1. Module is registered and appears in `--list` output
2. Module can be selected and executed via CLI
3. `config.yaml.example` includes Backup section with proper formatting
4. Example config follows existing patterns and style
5. Comments are clear and helpful for users

## Files Modified

- `main.go` - Register Backup module
- `config.yaml.example` - Add Backup configuration example

